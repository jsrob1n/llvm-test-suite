import site
import os
import json
import logging
site.addsitedir(os.path.dirname(__file__))
from litsupport import test

config.name = 'test-suite'
config.test_format = test.TestSuiteTest()
config.suffixes = ['.test']
config.excludes = ['ABI-Testsuite']
config.remote_flags = ""
config.traditional_output = True
config.single_source = False
if 'SSH_AUTH_SOCK' in os.environ:
    config.environment['SSH_AUTH_SOCK'] = os.environ['SSH_AUTH_SOCK']

previous_results_file = lit_config.params.get('previous', None)
if previous_results_file:
    config.previous_results = json.load(open(previous_results_file))
else:
    config.previous_results = None

logger = logging.getLogger()
logger.setLevel(logging.DEBUG)
file_log = logging.FileHandler("%s/test.log" % config.test_source_root,
                               mode="w")
file_log.setLevel(logging.DEBUG)
logger.addHandler(file_log)
console_log = logging.StreamHandler()
console_log.setLevel(logging.WARNING)
logger.addHandler(console_log)
